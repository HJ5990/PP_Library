-- 테이블 삭제
DROP TABLE RENTALLOG;
DROP TABLE BOOK;
DROP TABLE MEMBER;
DROP TABLE CATEGORY;

-- 테이블 생성
CREATE TABLE CATEGORY(
    C_NO NUMBER PRIMARY KEY,
    C_NAME VARCHAR2(20) UNIQUE NOT NULL
);

CREATE TABLE BOOK(
    B_NO NUMBER PRIMARY KEY,
    C_NO NUMBER REFERENCES CATEGORY NOT NULL,
    B_NAME VARCHAR2(50) NOT NULL,
    AUTHOR VARCHAR2(50) NOT NULL,
    PUBLISHDATE DATE NOT NULL,
    QUANTITY NUMBER NOT NULL
);

CREATE TABLE MEMBER(
    M_NO NUMBER PRIMARY KEY,
    M_ID VARCHAR2(20) UNIQUE NOT NULL,
    M_PWD VARCHAR2(20) NOT NULL,
    M_NAME VARCHAR2(20) NOT NULL,
    M_PHONE VARCHAR2(20)
);

CREATE TABLE ADMIN(
    A_NO NUMBER PRIMARY KEY,
    A_ID VARCHAR2(20) UNIQUE NOT NULL,
    A_PWD VARCHAR2(20) NOT NULL,
    A_NAME VARCHAR2(20) NOT NULL
);


CREATE TABLE RENTALLOG(
    R_NO NUMBER PRIMARY KEY,
    RR_DATE DATE NOT NULL,
    M_NO NUMBER REFERENCES MEMBER NOT NULL,
    B_NO NUMBER REFERENCES BOOK NOT NULL,
    RR_CHECK VARCHAR2(6) NOT NULL
);



-- 시퀀스 삭제
DROP SEQUENCE SEQ_BOOK;
DROP SEQUENCE SEQ_MEM;
DROP SEQUENCE SEQ_RENT;
DROP SEQUENCE SEQ_ADMIN;

-- 시퀀스 생성
CREATE SEQUENCE SEQ_BOOK
START WITH 101
NOCACHE;

CREATE SEQUENCE SEQ_MEM
START WITH 201
NOCACHE;

CREATE SEQUENCE SEQ_RENT
START WITH 1
NOCACHE;

CREATE SEQUENCE SEQ_ADMIN
START WITH 501
NOCACHE;


-- 카테고리 데이터
INSERT INTO CATEGORY VALUES (1, '문학');
INSERT INTO CATEGORY VALUES (2, '경제');
INSERT INTO CATEGORY VALUES (3, '교육');
INSERT INTO CATEGORY VALUES (4, '취미');
INSERT INTO CATEGORY VALUES (5, '만화');
INSERT INTO CATEGORY VALUES (6, '기타');

-- 책 데이터
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 1, '용의자 X의 헌신', '히가시노 게이고', '2006-08-10', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 1, '오만과 편견', '제인 오스틴', '2009-01-20', 5);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 1, '설득', '제인 오스틴', '2017-04-21', 5);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 1, '사피엔스', '유발 하라리', '2023-01-27', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 1, '해리포터', 'J.K.롤링', '2019-11-19', 5);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 1, '꽃을 보듯 너를 본다', '나태주', '2020-11-30', 2);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 2, '부자 아빠 가난한 아빠', '로버트 기요사키', '2022-10-28', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 2, '트렌드 코리아 2023', '김난도', '2022-10-05', 2);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 2, '돈의 속성', '김승호', '2020-06-15', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 3, '비전공자를 위한 IT 지식', '최원영', '2020-07-14', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 3, '바로 쓰는 영어', '셀리', '2022-07-20', 2);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 3, '10배의 법칙', '그랜트 카돈', '2022-03-30', 2);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 4, '어른을 위한 두뇌 놀이 책', '개러스 무어', '2021-08-20', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 4, '말랑말랑 스퀴시', '조윤성', '2022-07-05', 4);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 4, '방구석 미술관', '조원재', '2021-12-21', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 4, '김락희의 인체 드로잉', '김락희', '2019-11-26', 2);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 5, '원피스 101', '오다 에이치로', '2022-03-24', 5);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 5, '귀멸의 칼날 외전', '고토게 코요하루', '2021-12-25', 5);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 5, '명탐정 코난 100', '아오야마 고쇼', '2022-01-20', 5);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 6, '기분을 관리하면 인생이 관리된다', '김다슬', '2022-04-12', 2);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 6, '백년허리', '정선근', '2021-05-13', 2);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 6, '튼이 이유식', '정주희', '2019-01-03', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 6, '어떻게 말해줘야 할까', '오은영', '2020-10-25', 3);
INSERT INTO BOOK VALUES (SEQ_BOOK.NEXTVAL, 6, '법륜 스님의 반야심경 강의', '법륜', '2022-06-30', 2);

-- 회원 데이터
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'choi123', 'choi123', '최하나', '010-1234-1234');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'lee_2', 'lee_2', '이두이', '010-2222-2222');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'park33', 'park33', '박삼삼', '010-3333-3333');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'kim4', 'kim4', '김사망', '010-4444-4444');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'shin_55', 'shin_55', '신다섯', '010-5555-5555');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'soh06', 'soh06', '소육이', '010-6666-6666');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'oh777', 'oh777', '오칠칠', '010-7777-7777');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'shi8', 'shi8', '시여덟', '010-8888-8888');
INSERT INTO MEMBER VALUES (SEQ_MEM.NEXTVAL, 'googoo', 'googoo', '구구콘', '010-9999-9999');

-- 관리자 데이터
INSERT INTO ADMIN VALUES (SEQ_ADMIN.NEXTVAL, 'admin01', 'admin01', '관리자1');

-- 대여기록 데이터
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-08-01', 204, 105, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-08-01', 204, 109, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-08-15', 205, 105, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-08-27', 208, 102, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-09-03', 202, 120, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-09-03', 203, 113, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-09-06', 206, 105, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-09-07', 206, 118, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-09-07', 206, 102, '대여');
INSERT INTO RENTALLOG VALUES (SEQ_RENT.NEXTVAL, '2023-09-08', 207, 107, '대여');

COMMIT;


SELECT *
FROM BOOK
WHERE C_NO = 1 AND QUANTITY > 0;
